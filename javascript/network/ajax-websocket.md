### Ajax

- Asynchronous JavaScript and XML
- A web technology for creating application for interactive web pages
- Ajax will be disconnected after sending and receiving

### WebSocket

- A thin transport layer built on top of a device's TCP/IP stack
- Persistent connection, full-duplex, low-latency, event-driven communication
- WebSocket is a long connection; the session is kept
- WebSocket is used for real-time interaction data

### Polling

- Polling is a technique by which the client asking the server for new data regularly
- Two ways of polling: Short Polling and Long Polling
- Short polling is an Ajax-based timer that calls a fixed delays

```js
// Example of long polling
const subscribe = (callback) => {
  const pollUserEvents = () => {
    $.ajax({
      method: "GET",
      url: "http://localhost:8080/githubEvents",
      success: callback
      complete: pollUserEvents, // Recall every 30sec
      timeout: 30000
    });
  }

  pollUserEvents();
}
```

- Long polling will based on long-held http (Comet)
- If server support WebSocket protocol, it will agree to the upgrade and will communicate this through `Upgrade` header in the response

```js
// Client side
$(function() {
  window.WebSocket = window.WebSocket || window.MozWebSocket;
  const connection = new WebSocket("ws://localhost:8080/githubEvents");

  // connection is opened and ready to use
  connection.onopen = function() {}

  // an error occurred when sending/receiving data
  connection.onerror = function() {}

  // do something with data
  connection.onmessage = function(message) {}
})

// Server side
const express = require('express');
const events = require('./events');
const path = require('path');

const app = express();
const port = process.env.PORT || 5001;
const expressWs = require('express-ws')(app);

app.get('/', function(req, res) {
  res.sendFile(path.join(__dirname + '/static/index.html'));
});

app.ws('/', function(ws, req) {
  const githubEvent = {}; // sample github Event from Github event API https://api.github.com/events
  ws.send('message', githubEvent);
});

app.listen(port, function() {
  console.log('Listening on', port);
});
```

### SSE

- client established persistent and long-term connection with the server
- based on server-sent DOM event
- browsers can subscribe to a stream of events generated by server using the `EventSource` interface
- uses XHR streaming to transport messages over HTTP
- connection is one way

### Reference

- [Comparing WebSockets and Server-Sent Events](https://ably.com/blog/websockets-vs-sse)
- [Ajax Polling vs Long-Polling vs WebSockets vs Server-Sent Events](https://medium.com/geekculture/ajax-polling-vs-long-polling-vs-websockets-vs-server-sent-events-e0d65033c9ba)
